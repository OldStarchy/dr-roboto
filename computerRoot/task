-- global taskManager

local args = {...}

if (#args == 0) then
	args = {'list'}
end

local actions = {}

function actions.list()
	local tasks = taskManager:getTasks()

	print(#tasks .. ' tasks:')
	for i, task in ipairs(tasks) do
		print(' ' .. i .. ': ' .. tostring(task))
	end
end

function actions.help()
	print('Usage:')
	for i, _ in pairs(actions) do
		print(' task ' .. i)
	end
end

function actions.add(name)
	if (not isType(name, 'string')) then
		print('Must specifiy name')
		return
	end

	local task = Task(name)
	taskManager:addTask(task)
end

function actions.run()
	print('Start executing tasks? [Y/n] ')

	os.pullEvent('key')

	while (true) do
		local e, cc = os.pullEvent('key_up')

		if (cc == 28 or cc == 21) then
			break
		elseif (cc == 49) then
			return
		end
		os.pullEvent('key')
	end

	local skillSet = SkillSet.GetDefaultSkillSet()

	local runner = TaskRunner(skillSet, taskManager, true)

	runner:run()
end

local cmd = table.remove(args, 1)
if (actions[cmd] ~= nil) then
	actions[cmd](unpack(args))
else
	actions.help()
end
